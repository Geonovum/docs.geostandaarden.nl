<!DOCTYPE html><html lang="nl"><head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 34.1.4">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
  
  
  
  
  
<script>document.title = respecConfig.title</script>
<title>API Access control module</title>
  
  
<title>API Access control module</title>
  
<link rel="shortcut icon" type="image/x-icon" href="https://tools.geostandaarden.nl/respec/style/logos/Geonovum.ico">
  

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px}
</style>
<meta name="description" content="Dit betreft een technische module is die een aantal eisen invult voor API Access control.">
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #045D9F;
  }
</style>
<script type="text/javascript">
   /* Any custom mermaid.js scripts will go here. */
  </script>
<style>

  /* Any custom mermaid.js scripts will go here. */
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Geonovum",
  "nl_organisationPublishURL": "https://docs.geostandaarden.nl/",
  "logos": [
    {
      "src": "https://tools.geostandaarden.nl/respec/style/logos/Geonovum.svg",
      "alt": "Geonovum",
      "id": "Geonovum",
      "height": 67,
      "width": 132,
      "url": "https://www.geonovum.nl/geo-standaarden"
    }
  ],
  "postProcess": [
    null
  ],
  "latestVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/"
  ],
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "specStatus",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "publishDate"
  ],
  "prevVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "previousMaturity",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "previousPublishDate"
  ],
  "useLogo": true,
  "useLabel": true,
  "license": "cc-by",
  "addSectionLinks": true,
  "localizationStrings": {
    "en": {
      "wv": "Editor's draft",
      "cv": "Candidate recommendation",
      "vv": "Proposed recommendation",
      "def": "Recommendation",
      "basis": "Document",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Practical guideline",
      "hr": "Guide",
      "wa": "Work process agreement",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "basis": "Document",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen stabiel document.",
      "cv": "Dit is een consultatieversie. Commentaar over dit document kan gestuurd worden naar ",
      "vv": "Dit is de definitieve conceptversie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status."
    },
    "en": {
      "sotd": "Status of this document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a working draft that can be changed, removed or replaced by other documents at any time. It is not a stable document.",
      "cv": "This is a stable draft, published for public comment. Comments regarding this document may be sent to ",
      "vv": "This is the final draft of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing."
    }
  },
  "labelColor": {
    "def": "#045D9F",
    "wv": "#FF0000",
    "cv": "#045D9F",
    "vv": "#045D9F",
    "basis": "#80CC28"
  },
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/CC-Licentie.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/cc-by-nd.svg"
    }
  },
  "localBiblio": {
    "NCSC.TLS": {
      "href": "https://www.ncsc.nl/documenten/publicaties/2021/januari/19/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2.1",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS)",
      "authors": [
        "NCSC"
      ],
      "date": "Januari 2021"
    },
    "OAuth2": {
      "href": "https://tools.ietf.org/html/rfc6749",
      "title": "The OAuth 2.0 Authorization Framework",
      "authors": [
        "D. Hardt"
      ],
      "date": "October 2012",
      "publisher": "The Internet Engineering Task Force",
      "id": "oauth2"
    },
    "Expert": {
      "href": "https://www.forumstandaardisatie.nl/sites/bfs/files/Expertadvies%20OAuth%202.0.pdf",
      "title": "Expertadvies OAuth 2.0",
      "authors": [
        "P. Dam"
      ],
      "date": "24 februari 2017",
      "publisher": "Forum Standaardisatie"
    },
    "JWT": {
      "href": "https://tools.ietf.org/html/rfc7519",
      "title": "JSON Web Token (JWT)",
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "publisher": "IETF"
    },
    "JWS": {
      "href": "https://tools.ietf.org/html/rfc7515",
      "title": "JSON Web Signature (JWS)",
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "publisher": "IETF"
    },
    "JWE": {
      "href": "https://tools.ietf.org/html/rfc7516",
      "title": "JSON Web Encryption (JWE)",
      "authors": [
        "M. Jones, J. Hildebrand"
      ],
      "date": "may 2015",
      "publisher": "IETF"
    },
    "JWK": {
      "href": "https://tools.ietf.org/html/rfc7517",
      "title": "JSON Web Key (JWK))",
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "publisher": "IETF"
    },
    "JWA": {
      "href": "https://tools.ietf.org/html/rfc7518",
      "title": "JSON Web Algorithms (JWA)",
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "publisher": "IETF"
    },
    "PKCE": {
      "href": "https://tools.ietf.org/html/rfc7636",
      "title": "Proof Key for Code Exchange by OAuth Public Clients",
      "authors": [
        "N. Sakimura, J. Bradley, N. Agarwal"
      ],
      "date": "september 2015",
      "publisher": "IETF"
    },
    "Introspection": {
      "href": "https://tools.ietf.org/html/rfc7662",
      "title": "OAuth 2.0 Token Introspection",
      "authors": [
        "J. Richer"
      ],
      "date": "October 2015",
      "publisher": "IETF"
    },
    "OpenID.Core": {
      "href": "https://openid.net/specs/openid-connect-core-1_0.html",
      "title": "OpenID Connect Core 1.0",
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, B. de Medeiros, C. Mortimore"
      ],
      "date": "November 8 2014",
      "publisher": "OpenID foundation",
      "id": "openid.core"
    },
    "iGOV.OpenID": {
      "href": "https://openid.net/specs/openid-igov-openid-connect-1_0.html",
      "title": "International Government Assurance Profile (iGov) for OpenID Connect 1.0 - draft 3",
      "authors": [
        "M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "publisher": "OpenID foundation"
    },
    "iGOV.OAuth2": {
      "href": "https://openid.net/specs/openid-igov-oauth2-1_0.html",
      "title": "International Government Assurance Profile (iGov) for OAuth 2.0",
      "authors": [
        "J. Richer, M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "publisher": "OpenID foundation"
    },
    "OpenID.Discovery": {
      "href": "https://openid.net/specs/openid-connect-discovery-1_0.html",
      "title": "OpenID Connect Discovery 1.0",
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, E. Jay"
      ],
      "date": "November 8 2014",
      "publisher": "OpenID foundation"
    },
    "I-D.ietf-oauth-pop-architecture": {
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-pop-architecture-08",
      "title": "OAuth 2.0 Proof-of-Possession (PoP) Security Architecture",
      "authors": [
        "P. Hunt, J. Richer, W. Mills, P. Mishra, H. Tschofenig"
      ],
      "date": "July 8, 2016",
      "publisher": "IETF"
    },
    "HEART.OAuth2": {
      "href": "https://openid.net/specs/openid-heart-oauth2-1_0.html",
      "title": "Health Relationship Trust Profile for OAuth 2.0",
      "authors": [
        "J. Richer"
      ],
      "date": "April 25, 2017",
      "publisher": "OpenID foundation"
    },
    "JWS.JWE.Algs": {
      "href": "https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms",
      "title": "IANA JSON Web Signatures and Encryption Algorithms registry",
      "authors": [
        "Jim Schaad, Jeff Hodges, Joe Hildebrand, Sean Turner"
      ],
      "date": "",
      "publisher": "IANA"
    },
    "BCP195": {
      "href": "https://tools.ietf.org/html/bcp195",
      "title": "Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)",
      "authors": [
        "Y. Sheffer, R. Holz, P. Saint-Andre"
      ],
      "date": "May 2015",
      "publisher": "IETF"
    },
    "HAL": {
      "href": "http://stateless.co/hal_specification.html",
      "title": "HAL - Hypertext Application Language",
      "authors": [
        "Mike Kelly"
      ],
      "date": " 2013-09-18"
    },
    "rfc7946": {
      "href": "https://datatracker.ietf.org/doc/html/rfc7946",
      "title": "The GeoJSON Format",
      "authors": [
        "H. Butler, M. Daly, A. Doyle, S. Gillies, T. Schaub, S. Hagen"
      ],
      "date": "2016-08-01"
    },
    "OAuth2.Browser-Based-Apps": {
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps",
      "title": "OAuth 2.0 for Browser-Based Apps",
      "authors": [
        "A. Parecki",
        "D. Waite"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.browser-based-apps"
    }
  },
  "title": "API Access control module",
  "specStatus": "vv",
  "specType": "HR",
  "pubDomain": "api",
  "licence": "cc-by",
  "shortName": "access-control",
  "edDraftURI": "https://geonovum.github.io/KP-APIs/API-strategie-modules/access-control/",
  "publishDate": "2023-12-21",
  "publishVersion": "1.0.0",
  "previousPublishDate": "2023-05-24",
  "previousMaturity": "def",
  "editors": [
    {
      "name": "Kennisplatform API's",
      "company": "Kennisplatform API's",
      "companyURL": "https://github.com/Geonovum/KP-APIs"
    }
  ],
  "authors": [
    {
      "name": "Kennisplatform API's",
      "company": "Kennisplatform API's",
      "companyURL": "https://github.com/Geonovum/KP-APIs"
    }
  ],
  "github": "https://github.com/Geonovum/KP-APIs"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/base.css"></head>

<body class="h-entry informative"><div class="head">
    <a class="logo" href="https://www.geonovum.nl/geo-standaarden"><img alt="Geonovum" height="67" id="Geonovum" src="https://tools.geostandaarden.nl/respec/style/logos/Geonovum.svg" width="132">
  </a> <h1 id="title" class="title">API Access control module</h1>
    
    <h2>
      Geonovum Handreiking<br>
      Versie ter vaststelling
      <time class="dt-published" datetime="2023-12-21">21 december 2023</time>
    </h2>
    <dl>
      <dt>Deze versie:</dt><dd class="status">
              <a class="u-url status" href="https://docs.geostandaarden.nl/api/vv-hr-API-Strategie-mod-access-control-20231221">https://docs.geostandaarden.nl/api/vv-hr-API-Strategie-mod-access-control-20231221</a>
            </dd>
      <dt>Laatst gepubliceerde versie:</dt><dd>
              <a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-access-control/">https://docs.geostandaarden.nl/api/API-Strategie-mod-access-control/</a>
            </dd>
      <dt>Laatste werkversie:</dt><dd><a href="https://geonovum.github.io/KP-APIs/API-strategie-modules/access-control/">https://geonovum.github.io/KP-APIs/API-strategie-modules/access-control/</a></dd>
      
      
      
      <dt>Vorige versie:</dt><dd><a href="https://docs.geostandaarden.nl/api/API-Strategie-ext/#security">https://docs.geostandaarden.nl/api/API-Strategie-ext/#security</a></dd>
      
      <dt>Redacteur:</dt>
      <dd class="editor p-author h-card vcard">
    <span class="p-name fn">Kennisplatform API's</span> (<a class="p-org org h-org" href="https://github.com/Geonovum/KP-APIs">Kennisplatform API's</a>)
  </dd>
      
      <dt>Auteur:</dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Kennisplatform API's</span> (<a class="p-org org h-org" href="https://github.com/Geonovum/KP-APIs">Kennisplatform API's</a>)
  </dd>
      <dt>Doe mee:</dt><dd>
    <a href="https://github.com/Geonovum/KP-APIs/">GitHub Geonovum/KP-APIs</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/KP-APIs/issues/">Dien een melding in</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/KP-APIs/commits/">Revisiehistorie</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/KP-APIs/pulls/">Pull requests</a>
  </dd>
    </dl>
    
    
    
    <p class="copyright">
          Dit document valt onder de volgende licentie: 
          <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://tools.geostandaarden.nl/respec/style/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
        </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Samenvatting</h2><p>Dit betreft een technische module is die een aantal eisen invult voor API Access control.</p>
</section>
  <section id="sotd" class="introductory"><h2>Status van dit document</h2><p>Dit is de definitieve conceptversie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.</p></section><nav id="toc"><h2 class="introductory" id="inhoudsopgave">Inhoudsopgave</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Samenvatting</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status van dit document</a></li><li class="tocline"><a class="tocxref" href="#inleiding-van-de-nl-api-strategie"><bdi class="secno">1. </bdi>Inleiding van de NL API strategie</a></li><li class="tocline"><a class="tocxref" href="#access-control"><bdi class="secno">2. </bdi>Access Control</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">2.1 </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#api-access-patterns"><bdi class="secno">2.2 </bdi>API access patterns</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#machine-to-machine"><bdi class="secno">2.2.1 </bdi>Machine to machine</a></li><li class="tocline"><a class="tocxref" href="#rights-delegation"><bdi class="secno">2.2.2 </bdi>Rights delegation</a></li><li class="tocline"><a class="tocxref" href="#session-based-api-access-pattern"><bdi class="secno">2.2.3 </bdi>Session based API access pattern</a></li></ol></li><li class="tocline"><a class="tocxref" href="#identification"><bdi class="secno">2.3 </bdi>Identification</a></li><li class="tocline"><a class="tocxref" href="#authentication"><bdi class="secno">2.4 </bdi>Authentication</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#end-user-authentication"><bdi class="secno">2.4.1 </bdi>End-User authentication</a></li><li class="tocline"><a class="tocxref" href="#client-authentication"><bdi class="secno">2.4.2 </bdi>Client authentication</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#mutual-tls-authentication-mtls"><bdi class="secno">2.4.2.1 </bdi>Mutual TLS authentication (mTLS)</a></li><li class="tocline"><a class="tocxref" href="#private-key-jwt"><bdi class="secno">2.4.2.2 </bdi>Private key JWT</a></li><li class="tocline"><a class="tocxref" href="#client-secrets"><bdi class="secno">2.4.2.3 </bdi>Client secrets</a></li><li class="tocline"><a class="tocxref" href="#client-authentication-and-public-clients"><bdi class="secno">2.4.2.4 </bdi>Client authentication and Public clients</a></li><li class="tocline"><a class="tocxref" href="#other-authentication-methods"><bdi class="secno">2.4.2.5 </bdi>Other Authentication Methods</a></li></ol></li><li class="tocline"><a class="tocxref" href="#client-credentials-using-oauth-2-0"><bdi class="secno">2.4.3 </bdi>Client Credentials using OAuth 2.0</a></li></ol></li><li class="tocline"><a class="tocxref" href="#authorization"><bdi class="secno">2.5 </bdi>Authorization</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authorization-errors"><bdi class="secno">2.5.1 </bdi>Authorization errors</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>Referenties</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#informatieve-referenties"><bdi class="secno">A.1 </bdi>Informatieve referenties</a></li></ol></li></ol></nav>
  <section data-format="markdown" class="informative" id="inleiding-van-de-nl-api-strategie"><div class="header-wrapper"><h2 id="x1-inleiding-van-de-nl-api-strategie"><bdi class="secno">1. </bdi>Inleiding van de NL API strategie</h2><a class="self-link" href="#inleiding-van-de-nl-api-strategie" aria-label="Permalink for Section 1."></a></div><p><em>Dit onderdeel is niet normatief.</em></p>
<p>Dit Hoofdstuk geeft een inleiding op de Nederlandse API strategie. De stategie is opgebouwd uit meerdere documenten, standaarden en modulen. De NL API Strategie wordt doorontwikkeld en beheerd door <a href="https://www.geonovum.nl/themas/kennisplatform-apis">het Kennisplatform API's</a>.</p>
<div class="header-wrapper"><h2 id="status">Status</h2><a class="self-link" href="#inleiding-van-de-nl-api-strategie" aria-label="Permalink for this Section"></a></div>
<p>Op <a href="https://github.com/geonovum/KP-APIs/issues">GitHub</a> kan bekeken worden wat de actuele ontwikkelingen zijn met betrekking tot de Nederlandse API strategie. </p>
<div class="header-wrapper"><h2 id="auteurs">Auteurs</h2><a class="self-link" href="#inleiding-van-de-nl-api-strategie" aria-label="Permalink for this Section"></a></div>
<p>Er worden slechts een beperkt aantal auteurs genoemd, echter aan deze strategie is door veel meer mensen gewerkt. Per onderdeel van de API strategie staan de degene verantwoordelijk voor de laatste versie vermeld.
De genoemde auteurs zijn deelnemers aan de relevante werkgroep van het Kennisplatform API's zoals: API Strategie, Architectuur, Security, Design Rules, Authenticatie en Autorisatie, Strategie en Beleid, en Gebruikerswensen.</p>
<div class="header-wrapper"><h2 id="leeswijzer">Leeswijzer</h2><a class="self-link" href="#inleiding-van-de-nl-api-strategie" aria-label="Permalink for this Section"></a></div>
<p>De API strategie bestaat uit een een inleidend document, verschillende normatieve documenten (NL GOV standaarden) en meerdere modulen die voor verschillende functionele of technische situaties kunnen worden ingezet. Een actueel overzicht van alle documenten is weergegeven in de onderstaande infographic:</p>
<figure id="fig-nl-api-strategie-infographic">
  <object data="https://geonovum.github.io/KP-APIs/media/API_infographic.svg" type="image/svg+xml" id="infographic"></object>
  <figcaption><a class="self-link" href="#fig-nl-api-strategie-infographic">Figuur <bdi class="figno">1</bdi></a> <span class="fig-title">NL API Strategie Infographic</span></figcaption>
</figure>

<p>De verschillende onderdelen van de NL API Strategie bevat de volgende documenten:</p>
<table class="simple">
<thead>
<tr>
<th>Onderdeel</th>
<th>Documentnaam &amp; <br> Verwijzing naar de gepubliceerde versie</th>
<th>Status</th>
<th>Versie</th>
</tr>
</thead>
<tbody><tr>
<td>Algemeen</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie/">Inleiding NL API Strategie</a></td>
<td>Vastgesteld <br> (door Kennisplatform)</td>
<td>09-03-2022</td>
</tr>
<tr>
<td>Algemeen</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie-architectuur/">Architectuur NL API Strategie</a></td>
<td>Vastgesteld <br> (door Kennisplatform)</td>
<td>09-03-2022</td>
</tr>
<tr>
<td>Algemeen</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie-gebruikerswensen/">Gebruikerswensen NL API Strategie</a></td>
<td>Vastgesteld <br> (door Kennisplatform)</td>
<td>09-03-2022</td>
</tr>
<tr>
<td>Normatieve standaard</td>
<td><a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/">API Design Rules (ADR)</a></td>
<td>Verplicht <br> (pas toe leg uit)</td>
<td>09-07-2020 <br> v1.0.0</td>
</tr>
<tr>
<td>Verplichte standaard</td>
<td><a href="https://forumstandaardisatie.nl/open-standaarden/openapi-specification">Open API Specification (OAS)</a></td>
<td>Verplicht <br> (pas toe leg uit)</td>
<td>25-05-2018 <br> v3.0.0</td>
</tr>
<tr>
<td>Normatieve standaard</td>
<td><a href="https://gitdocumentatie.logius.nl/publicatie/api/oauth/">NL GOV OAuth profiel</a></td>
<td>Verplicht <br> (pas toe leg uit)</td>
<td>09-07-2020 <br> v1.0.0</td>
</tr>
<tr>
<td>Voorgestelde standaard</td>
<td><a href="https://logius.gitlab.io/oidc/">NL GOV OpenID Connect profile</a></td>
<td>Verplicht <br> (pas toe leg uit)</td>
<td>18-02-2021 <br> v1.0.0</td>
</tr>
<tr>
<td>Verplichte standaard</td>
<td><a href="https://gitdocumentatie.logius.nl/publicatie/dk/restapi/">Digikoppeling REST API koppelvlak specificatie</a></td>
<td>Verplicht <br> (pas toe leg uit)</td>
<td>14-11-2022 <br> v1.1.1</td>
</tr>
<tr>
<td>Aanvullende module</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-geo/">API Geospatial Design Rules module</a></td>
<td>Vastgesteld * <br> (door Kennisplatform)</td>
<td>23-05-2023</td>
</tr>
<tr>
<td>Aanvullende module</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-transport-security/">API Transport Security module</a></td>
<td>Stabiel * <br> (Werkgroep Kennisplatform)</td>
<td>11-07-2023</td>
</tr>
<tr>
<td>Aanvullende module</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-access-control/">API Access control module</a></td>
<td>Stabiel <br> (Werkgroep Kennisplatform)</td>
<td>11-07-2023</td>
</tr>
<tr>
<td>Aanvullende module</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-naming-conventions/">API Naming conventions module</a></td>
<td>Stabiel <br> (Werkgroep Kennisplatform)</td>
<td>12-07-2023</td>
</tr>
<tr>
<td>Aanvullende module</td>
<td><a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-hypermedia/">API Hypermedia module</a></td>
<td>Stabiel <br> (Werkgroep Kennisplatform)</td>
<td>12-07-2023</td>
</tr>
</tbody></table>
<ul>
<li>Deze modules zijn voordragen als normatief, vaststellingsproces is nog niet compleet</li>
</ul>
</section>
  <section id="access-control"><div class="header-wrapper"><h2 id="x2-access-control"><bdi class="secno">2. </bdi>Access Control</h2><a class="self-link" href="#access-control" aria-label="Permalink for Section 2."></a></div>
<section id="introduction"><div class="header-wrapper"><h3 id="x2-1-introduction"><bdi class="secno">2.1 </bdi>Introduction</h3><a class="self-link" href="#introduction" aria-label="Permalink for Section 2.1"></a></div>
<p>This section describes security principles, concepts and technologies to apply when working with APIs. Controls need to be applied for the security objectives of integrity, confidentiality and availability of the API and services and data provided thereby. The (new draft of the) <a href="https://docs.geostandaarden.nl/api/cv-hr-API-Strategie-20210628/#architectuur">architecture section of the API strategy</a> contains architecture patterns for implementing API security. This module provides the details on the authentication &amp; authorization capability of the API capability model detailed in the (new draft of the) <a href="https://geonovum.github.io/KP-APIs/API-strategie-algemeen/Architectuur/">architecture section of the API strategy</a>.</p>
<p>The scope of this section is limited to generic security controls that directly influence the visible parts of an API. Effectively, only security standards directly applicable to interactions are discussed here.
In order to meet the complete security objectives, every implementer MUST also apply a range of controls not mentioned in this section.</p>
<p>Note: security controls for signing and encrypting of application level messages will be part of a separate extension, Signing and Encryption.</p>
</section><section id="api-access-patterns"><div class="header-wrapper"><h3 id="x2-2-api-access-patterns"><bdi class="secno">2.2 </bdi>API access patterns</h3><a class="self-link" href="#api-access-patterns" aria-label="Permalink for Section 2.2"></a></div>
<p>Because security is about compromises one should first be aware of what access patterns need to be supported. More information on API access patterns can be found in Dutch in <a href="https://docs.geostandaarden.nl/api/API-Strategie/Architectuur/">the architecture chapter of the Dutch API strategy</a></p>
<section id="machine-to-machine"><div class="header-wrapper"><h4 id="x2-2-1-machine-to-machine"><bdi class="secno">2.2.1 </bdi>Machine to machine</h4><a class="self-link" href="#machine-to-machine" aria-label="Permalink for Section 2.2.1"></a></div>
<p>Two different machines negotiate a secure point to point connection. One side acts as the client, the other as the server. Both sides identify and authenticate the other party.
The server authorizes access to its resources by the client based on the established identity of the client. The authorizations for a client are determined by doing a lookup to an identity store based on the established identity of the client.
Note that in Dutch government we often only identify organizations and not individual machines or their users. Therefor the access rights or permissions associated with a given identity might be far greater than needed. This is breaking the principle of least privilege.</p>
</section><section id="rights-delegation"><div class="header-wrapper"><h4 id="x2-2-2-rights-delegation"><bdi class="secno">2.2.2 </bdi>Rights delegation</h4><a class="self-link" href="#rights-delegation" aria-label="Permalink for Section 2.2.2"></a></div>
<p>In the rights delegation pattern a system is granted access to a resource by and on behalf of the owner of that resource. The rights delegation access pattern can help solve the problem of machines having greater permissions/priviliges/access rights than necessary for the task at hand.
Retrieving a resource at run-time requires a resource owner, a client, an authorization server and a resource server. The resource owner (often the end user) grants permissions to the client to access resources on its behalf.
This grant is stored at the authorization server, after permissions are granted to the client to access resources on the resource server; with or without the presence of an end user.</p>
<p>When a resource owner provides a grant to the client, this grant SHOULD only contain the permissions the client needs to perform its intended tasks.
To deny the client access to these resources after initial permission is granted, the resource owner MUST revoke the grant at the authorization server or the grant might be revoked after a predefined expiration period.</p>
</section><section id="session-based-api-access-pattern"><div class="header-wrapper"><h4 id="x2-2-3-session-based-api-access-pattern"><bdi class="secno">2.2.3 </bdi>Session based API access pattern</h4><a class="self-link" href="#session-based-api-access-pattern" aria-label="Permalink for Section 2.2.3"></a></div>
<p>While this method is considered legacy it is in common use for handling access control to APIs, even though it conflicts with best practices for APIs. Because this pattern is more a standard web application pattern we refer to <a href="https://www.ncsc.nl/documenten/publicaties/2019/mei/01/ict-beveiligingsrichtlijnen-voor-webapplicaties">the latest NCSC guidelines on the subject of web application security</a> for security considerations.</p>
<p>We consider this method to be mostly outside the scope of this document and refer to the aforementioned NCSC document for security considerations. We do provide some additional considerations for web clients in the section on <a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-transport-security/">transport Security</a>.</p>
</section></section><section id="identification"><div class="header-wrapper"><h3 id="x2-3-identification"><bdi class="secno">2.3 </bdi>Identification</h3><a class="self-link" href="#identification" aria-label="Permalink for Section 2.3"></a></div>
<p><strong>End Users and Organizations</strong>
For identification of individual end users a pseudonym SHOULD be used when possible, to avoid exposing sensitive information about a user.
This pseudonym can optionally be translatable to actual personal information in a separate service, but access to this service should be tightly controlled and limited only to cases where there is a legal need to use this information. Furthermore using a seperate service for translation provides a moment to audit when certain information about users is requested.</p>
<p>Use of a Burger Service Number (BSN) is only allowed when the organization has a legal ground to do so. Even when an organization is eligible to use BSN's it is still RECOMMENDED to use a pseudonym that is only translatable to a BSN for a limited number of services/users within the organization.
An example of this can be found in the <a href="https://aandeslagmetdeomgevingswet.nl/publish/library/219/dso_-_gas_-_knooppunt_toegang_iam.pdf">architecture of the "digitaal stelsel omgevingswet (DSO)"</a></p>
<p>For identifying government organizations use the "organisatie-identificatienummer" (OIN).</p>
<p>For identifying non-government organizations (companies, associations, foundations etc...) use the KVK number. These numbers are used in the PKIOverheid and e-Herkenning context respectively. See <a href="https://publicatie.centrumvoorstandaarden.nl/dk/oin/">https://publicatie.centrumvoorstandaarden.nl/dk/oin/</a> and <a href="https://www.kvk.nl/over-kvk/over-het-handelsregister/">https://www.kvk.nl/over-kvk/over-het-handelsregister/</a> for more information on these identifiers.</p>
<p>OIN's can be queried using the COR API <a href="https://portaal.digikoppeling.nl/registers/corApi/index">https://portaal.digikoppeling.nl/registers/corApi/index</a> or its webpage <a href="https://portaal.digikoppeling.nl/registers/">https://portaal.digikoppeling.nl/registers/</a>. The API will also provide known mappings between OIN- and KVK numbers (some OIN's are not derived from the KVK number). KVK numbers are derived from the handelsregister, which can be queried see <a href="https://developers.kvk.nl/documentation/search-v2">https://developers.kvk.nl/documentation/search-v2</a> for details.</p>
<p>In the EU context use the eIDAS legal identifier. For more information see <a href="https://ec.europa.eu/digital-single-market/en/trust-services-and-eid">https://ec.europa.eu/digital-single-market/en/trust-services-and-eid</a> and <a href="https://afsprakenstelsel.etoegang.nl/">https://afsprakenstelsel.etoegang.nl/</a> for details.</p>
<p><strong>Clients</strong>
Identification of clients is different from identification of the end user or organisation using the service.
When using authorization servers, the authorization server issues the registered client a client identifier - a unique string representing the registration information provided by the client. The client identifier is not a secret; it is commonly public known and MUST NOT be relied upon for client authentication by itself. The client identifier is unique to the authorization server.</p>
<p>Authorization servers MUST NOT allow clients to choose or influence their <code>client_id</code> value.</p>
</section><section id="authentication"><div class="header-wrapper"><h3 id="x2-4-authentication"><bdi class="secno">2.4 </bdi>Authentication</h3><a class="self-link" href="#authentication" aria-label="Permalink for Section 2.4"></a></div>
<p>Authentication determines whether individuals and applications accessing APIs are really who they say they are. In the context of APIs, authentication is applicable to the <em>End-User</em>, i.e. the individual on behalf of whom API resources are being accessed, <em>and</em> to the <em>Client</em>, i.e. the application that accesses the API resources on behalf of the End-User.</p>
<p>Note that an End-User can be both a natural person as well as a legal person (organization). In case Client Authentication includes information about its governing organization, this may fulfill and obviate the need for End-User authentication. See the section "Client Credentials using OAuth 2.0" below.</p>
<section id="end-user-authentication"><div class="header-wrapper"><h4 id="x2-4-1-end-user-authentication"><bdi class="secno">2.4.1 </bdi>End-User authentication</h4><a class="self-link" href="#end-user-authentication" aria-label="Permalink for Section 2.4.1"></a></div>
<p>In most Use Cases that involve API interaction, authenticating the End-User on behalf of whom the API resources are accessed is required. This is typically matches with the rights delegation API access pattern.
End-User authentication is not required in situations where the API Client is solely accessing API resources on behalf of itself or its governing organization, without requiring an End-User context, but may be used nevertheless. This happens in the machine to machine API access pattern.</p>
<p>The following methods can be used for End-User authentication:</p>
<p><strong>SAML</strong>
SAML is a standard for securely communicating assertions about an authenticated End-User from the Identity Provider to the Service Provider. Although it existed before APIs became mainstream and is not aimed at API authentication specifically, communicating Access Tokens that can be used to access API resources in the exchanged assertions is possible.</p>
<p><a href="https://forumstandaardisatie.nl/open-standaarden/saml">SAML 2.0 is included on the list of required standards by Forum Standaardisatie</a>. It is expected, however, that the following standards will become preferred over SAML in Use Cases that involve access to API resources.</p>
<p><strong>OAuth</strong>
Although technically an authorization method, OAuth [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2" title="The OAuth 2.0 Authorization Framework">OAuth2</a></cite>] is used as well for authenticating End-Users themselves and providing the Client with an Access Token upon successful End-User (and Client) authentication. This Access Token can be used to make authorized API requests. Using OAuth is appropriate when authorization is not dependent on an identifiable subject, the subject is different from the End-User or the Resource Server does not require authentication of the End-User itself.</p>
<p>The NL GOV Assurance profile for OAuth 2.0 is included on the list of required standards by Forum Standaardisatie. The latest version of the profile can be found at <a href="https://publicatie.centrumvoorstandaarden.nl/api/oauth/">https://publicatie.centrumvoorstandaarden.nl/api/oauth/</a>.</p>
<p><strong>OpenID Connect</strong>
OpenID Connect [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>] adds an identity layer on top of OAuth, making it into an actual authentication method. It enables API Clients to verify the identity of authenticated End-Users and to obtain profile information about the End-User.</p>
<p>A Dutch Assurance profile for OpenID Connect is currently being drafted. It is expected to be added to the list of required standards by Forum Standaardisatie. The latest version of the draft profile can be found at <a href="https://logius.gitlab.io/oidc/">https://logius.gitlab.io/oidc/</a>.</p>
<p><strong>Out of band</strong>
For some Use Cases it may be appropriate to distribute Access Tokens using an Out of band method. Out of band authentication is generally appropriate when API resources are accessed via an application that already supports a client authentication method and the End-User is rather static. Based on an End-User authentication performed, the application subsequently is provided with an Access Token for API access via a secure method.</p>
<p>Depending on the technology used by the applications accessing the API the Access Token may technically be communicated using a secure cookie. This however limits the technologies used to create client applications.</p>
<p>Using sessions and secure cookies is outside the scope of this document. For security considerations please refer to <a href="https://www.ncsc.nl/documenten/publicaties/2019/mei/01/ict-beveiligingsrichtlijnen-voor-webapplicaties">the latest NCSC guidelines on the subject of web application security</a>.</p>
</section><section id="client-authentication"><div class="header-wrapper"><h4 id="x2-4-2-client-authentication"><bdi class="secno">2.4.2 </bdi>Client authentication</h4><a class="self-link" href="#client-authentication" aria-label="Permalink for Section 2.4.2"></a></div>
<p>The Client application that accesses API resources SHOULD be authenticated, both in the machine to machine and in the rights delegation API access patterns. Also note that, although listed separately, the aforementioned methods for End-User authentication require Client authentication as well.</p>
<p>Note: Client Authentication is applicable to the Client accessing the API, the Client making request to the Authorization Server when applying OAuth/OpenID, or both. Client Authentication SHOULD be applied for both uses.</p>
<p>It is RECOMMENDED to use asymmetric (public-key based) methods for client authentication such as mTLS <a href="https://www.rfc-editor.org/info/rfc8705">RFC8705</a> or "private_key_jwt" <a href="https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication">OpenID</a>.</p>
<p><a href="https://gitdocumentatie.logius.nl/publicatie/api/oauth/">The NL GOV Assurance profile for OAuth 2.0</a> REQUIRES the use of private_key_jwt for full clients, native clients with dynamically registered keys, and direct access clients as mentioned in the profile.</p>
<p>The following methods can be used for Client authentication.</p>
<section id="mutual-tls-authentication-mtls"><div class="header-wrapper"><h5 id="x2-4-2-1-mutual-tls-authentication-mtls"><bdi class="secno">2.4.2.1 </bdi>Mutual TLS authentication (mTLS)</h5><a class="self-link" href="#mutual-tls-authentication-mtls" aria-label="Permalink for Section 2.4.2.1"></a></div>
<p>Mutual TLS authentication, is a feature of TLS with which the Client authenticates itself to the Server using its X.509 certificate. Mutual TLS (mTLS) provides strong Client authentication for server-based Clients and cannot be used with Native or User-Agent-based Clients that are not backed with a server. Support for mTLS in combination with OAuth2 is specified in <a href="https://www.rfc-editor.org/info/rfc8705">RFC8705</a>.</p>
<p>In contexts where Dutch (semi) governmental organizations are involved, the X.509 certificate used for Client authentication MUST be a PKIOverheid certificate. These are x509 certificates derived from a root certificate owned by the Dutch Government. For more information on PKIOverheid see <a href="https://www.logius.nl/diensten/pkioverheid">https://www.logius.nl/diensten/pkioverheid</a>.</p>
<p>In the API context, only Server, Services certificates or extended Validation certificates (as used for websites) SHOULD be used. Please note that in the current standard of PKIO the TSPs are not obligated to fill the OIN / HRN in the Subject.Serialnumber field for the private services chain, as it is optional. See the <a href="https://www.logius.nl/sites/default/files/bestanden/website/PvE%20deel3h%20v4.8%20V1.0.pdf">Programme of Requirements part 3h: CP Server certificaten – domein Private Services</a> for details. For the extended Validation certificates, the chamber of commerce number is given in the Serial.Subject field see <a href="https://www.logius.nl/sites/default/files/public/bestanden/diensten/PKIoverheid/PvE%20EN%20part3f%20v4.8%20DEF.pdf">Programme of Requirements part 3f: Certificate Policy for Extended Validation certificates in EV (G1) Domain</a> or the <a href="https://www.logius.nl/diensten/pkioverheid/aansluiten-als-tsp/pogramma-van-eisen">website of Logius</a> for details.
See also the NCSC factsheet regarding the phasing out of publicly trusted web server (SSL/TLS) certificates by PKIOverheid :
<a href="https://www.logius.nl/actueel/ncsc-maakt-factsheet-over-uitfasing-webcertificaten-van-pkioverheid">Factsheet PKIoverheid stopt met webcertificaten</a>.</p>
</section><section id="private-key-jwt"><div class="header-wrapper"><h5 id="x2-4-2-2-private-key-jwt"><bdi class="secno">2.4.2.2 </bdi>Private key JWT</h5><a class="self-link" href="#private-key-jwt" aria-label="Permalink for Section 2.4.2.2"></a></div>
<p>With Private key JWT authentication <a href="https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication">OpenID</a>, the Client registers a public key with the Server and accompanies every API request with a JWT signed using this key. This Client Authentication method is part of the OpenID Connect standards for Clients authenticating to the OpenID Provider, but the use of Private key JWT Client authentication is not limited to this use case.</p>
<p>This authentication method may be used with Clients that are able to securely store asymmetric private keys and sign JWT's with this key.</p>
<p>In contexts where Dutch (semi) governmental organizations are involved, the certificate used for signing the Private key JWT's MUST be a PKIOverheid certificate. In case the certificate is included in the JWT header, it includes identification of the client and registration of the public key may not be necessary.</p>
<p><a href="https://publicatie.centrumvoorstandaarden.nl/api/oauth/">The NL GOV Assurance profile for OAuth 2.0</a> REQUIRES the use of private_key_jwt for full clients, native clients with dynamically registered keys, and direct access clients as mentioned in the profile.</p>
</section><section id="client-secrets"><div class="header-wrapper"><h5 id="x2-4-2-3-client-secrets"><bdi class="secno">2.4.2.3 </bdi>Client secrets</h5><a class="self-link" href="#client-secrets" aria-label="Permalink for Section 2.4.2.3"></a></div>
<p>Clients SHOULD NOT be authenticated using client secrets. Methods using asymmetric keys are RECOMMENDED instead of client secrets, as they are both more secure and key management is easier, in particular when deployed at scale.  Various methods exists for authenticating clients using secrets. Methods including Client authentication using HTTP Basic authentication or communicating client credentials in the request body are prone to credential theft.</p>
</section><section id="client-authentication-and-public-clients"><div class="header-wrapper"><h5 id="x2-4-2-4-client-authentication-and-public-clients"><bdi class="secno">2.4.2.4 </bdi>Client authentication and Public clients</h5><a class="self-link" href="#client-authentication-and-public-clients" aria-label="Permalink for Section 2.4.2.4"></a></div>
<p>In Use Cases that involve Native and User-Agent based Clients, strong Client authentication is generally not possible. Whereas it may be possible for individual Clients to implement a decent means of Client authentication (e.g. by using the Web Crypto API in User-Agent based Clients), the Server cannot make any assumptions about the confidentiality of credentials exchanged with such Clients.</p>
<p>When dealing with Use Cases involving Native and User-Agent based Clients, the policies and standards described in <a href="https://geonovum.github.io/KP-APIs/API-strategie-modules/transport-security/#http-level-security">Section HTTP level security</a> SHOULD be followed, as well as best practices [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.browser-based-apps" title="OAuth 2.0 for Browser-Based Apps">OAuth2.Browser-Based-Apps</a></cite>] and [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>], which are defined for use with OAuth but may be applicable for API communication in general.</p>
</section><section id="other-authentication-methods"><div class="header-wrapper"><h5 id="x2-4-2-5-other-authentication-methods"><bdi class="secno">2.4.2.5 </bdi>Other Authentication Methods</h5><a class="self-link" href="#other-authentication-methods" aria-label="Permalink for Section 2.4.2.5"></a></div>
<p>An API Server (Resource Server) or Authorization Server MAY support any suitable authentication scheme matching their security requirements. When using other authentication methods, the authorization server MUST define a mapping between the client identifier (registration record) and authentication scheme.</p>
<p>Some additional authentication methods are defined in the <a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#token-endpoint-auth-method">OAuth Token Endpoint Authentication Methods</a> registry, and may be useful as generic client authentication methods beyond the specific use of protecting the token endpoint.</p>
</section></section><section id="client-credentials-using-oauth-2-0"><div class="header-wrapper"><h4 id="x2-4-3-client-credentials-using-oauth-2-0"><bdi class="secno">2.4.3 </bdi>Client Credentials using OAuth 2.0</h4><a class="self-link" href="#client-credentials-using-oauth-2-0" aria-label="Permalink for Section 2.4.3"></a></div>
<p>In Use Cases where the Client is solely accessing API resources on behalf of itself or its governing organization, without requiring an End-User context, Client authentication using the OAuth 2.0 Client Credentials grant type can be appropriate. In such cases, the Authorization Server securely provides Client credentials to the Client upon registration (e.g. via an API Developer portal or out of bound process) and the Client uses these credentials to obtain an Access Token from the Authorization Server. The Access token than is used to access the API (Resource Server) using the Access Token.</p>
<p>Note that existing Client Credentials, such as a PKIoverheid X.509 certificate, MAY be used. This preempts the need for providing additional credentials. Any of the above mentioned Client Authentication methods can be applied with the Client Credential flow.</p>
<p>Usage of the Client Credential method with OAuth is RECOMMENDED over direct authorization by the API Server (Resource Server), even if the authorization decision can be based directly on Client Authentication. This externalizes the authorization decision from the API implementation, allowing for easier modifications and management of both the decision logic as well as client authentication methods.</p>
</section></section><section id="authorization"><div class="header-wrapper"><h3 id="x2-5-authorization"><bdi class="secno">2.5 </bdi>Authorization</h3><a class="self-link" href="#authorization" aria-label="Permalink for Section 2.5"></a></div>
<p>It is RECOMMENDED to use token-based access to APIs. REST APIs SHOULD NOT maintain session state on the server. The authentication and authorization of a request SHOULD NOT depend on sessions. Instead, a token has to be sent with each request.</p>
<div class="rule" id="api-13">
  <p class="rulelab"><strong>API-13</strong>: Accept tokens as HTTP headers only</p>
  <p>There is an inherent security issue when passing tokens as a query parameter, because most Web servers store query parameters in the server logs.</p>
</div>

<p>Using tokens, a distinction is made between authorized and non-authorized services and related headers:</p>
<table class="simple">
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Authorized</td>
<td><code>Authorization: Bearer &lt;token&gt;</code></td>
</tr>
<tr>
<td>Non-authorized</td>
<td><code>X-Api-Key: &lt;api-key&gt;</code></td>
</tr>
</tbody></table>
<p>In case the proper headers are not sent, then there are no authentication details available and a status error code <code>403 Forbidden</code> is returned.</p>
<div class="rule" id="api-52">
  <p class="rulelab"><strong>API-52</strong>: Use OAuth 2.0 for authorization with rights delegation</p>
  <p>This is in line with the way the OAuth standard appears on the comply or explain list of Forum Standaardisatie.</p>
</div>

<p>See also <a href="https://gitdocumentatie.logius.nl/publicatie/api/oauth/">The NL GOV Assurance profile for OAuth 2.0</a> for further explanation of the applicaton of OAuth.</p>
<p>The <a href="https://publicatie.centrumvoorstandaarden.nl/dk/actueel/">Digikoppeling standard</a> currently has a <a href="https://gitdocumentatie.logius.nl/publicatie/dk/restapi/">RESTful API profile in development</a> that specifies how to use PKIOverheid x.509 certificates for authorization.</p>
<section id="authorization-errors"><div class="header-wrapper"><h4 id="x2-5-1-authorization-errors"><bdi class="secno">2.5.1 </bdi>Authorization errors</h4><a class="self-link" href="#authorization-errors" aria-label="Permalink for Section 2.5.1"></a></div>
<p>In a production environment as little information as possible is to be disclosed. Apply the following rules for returning the status error code <code>401 Unauthorized</code>, <code>403 Forbidden</code>, and <code>404 Not Found</code>.</p>
<p>Note that authentication in the cases below is typically client authentication, and the Authorization header contains information on the End-User authorization and authentication, if applicable.</p>
<p>Note that usage of the Authorization header is part of the OAuth2 specifications.</p>
<p><strong>Implicit authentication</strong></p>
<p>When authentication is implicit or when just the presence of an Authorization header is enough for authentication and/or authorization: use the flow chart in figure 1 to determine the correct error code.</p>
<figure id="fig-authentication-is-implicit">
    <img alt="flowchart describing responses when authentication is implicit" src="media/HTTP-FlowChart1.PNG">
    <figcaption><a class="self-link" href="#fig-authentication-is-implicit">Figuur <bdi class="figno">2</bdi></a> <span class="fig-title">authentication is implicit</span></figcaption>
</figure>


<p>Links from flow chart in figure above:</p>
<p><a href="https://tools.ietf.org/html/rfc6750#section-3.1">https://tools.ietf.org/html/rfc6750#section-3.1</a></p>
<p><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">https://tools.ietf.org/html/rfc7231#section-6.5.4</a></p>
<p><strong>Explicit authentication</strong></p>
<p>When authentication is explicit, that is the authentication credentials are actively verfied when present, use the flow chart in figure 2 to determine the correct error codes.</p>
<figure id="fig-authentication-is-explicit">
    <img alt="flowchart describing responses when authentication is explicit" src="media/HTTP-FlowChart2.PNG">
    <figcaption><a class="self-link" href="#fig-authentication-is-explicit">Figuur <bdi class="figno">3</bdi></a> <span class="fig-title">authentication is explicit</span></figcaption>
</figure>

<p>Links from flow chart in figure above:</p>
<p><a href="https://tools.ietf.org/html/rfc7235#section-3.1">https://tools.ietf.org/html/rfc7235#section-3.1</a></p>
<p><a href="https://tools.ietf.org/html/rfc6750#section-3.1">https://tools.ietf.org/html/rfc6750#section-3.1</a></p>
<p><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">https://tools.ietf.org/html/rfc7231#section-6.5.4</a></p>
<p><strong>Explicit authentication while matching client authorization (<code>cnf</code>)</strong></p>
<p>When authentication is explicit and there is a check whether the provided authorization confirmation claim (<code>cnf</code>, see [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7800" title="Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)">rfc7800</a></cite>]) matches the credentials provided for authentication use the flow chart in figure 3 to esteblish the correct error codes.</p>
<figure id="fig-authentication-is-explicit-and-client-authorization-confirmation-claim-cnf-matches-authentication">
    <img alt="flowchart describing responses when authentication is explicit and client authorization confirmation claim (`cnf`) matches authentication." src="media/HTTP-FlowChart3.PNG">
    <figcaption><a class="self-link" href="#fig-authentication-is-explicit-and-client-authorization-confirmation-claim-cnf-matches-authentication">Figuur <bdi class="figno">4</bdi></a> <span class="fig-title">authentication is explicit, and client authorization confirmation claim (<code>cnf</code>) matches authentication.</span></figcaption>
</figure>

<p>Links from flow chart in figure above:</p>
<p><a href="https://tools.ietf.org/html/rfc7235#section-3.1">https://tools.ietf.org/html/rfc7235#section-3.1</a></p>
<p><a href="https://tools.ietf.org/html/rfc6750#section-3.1">https://tools.ietf.org/html/rfc6750#section-3.1</a></p>
<p><a href="https://tools.ietf.org/html/rfc7800">https://tools.ietf.org/html/rfc7800</a></p>
<p><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">https://tools.ietf.org/html/rfc7231#section-6.5.4</a></p>
</section></section></section>
  



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-referenties"><bdi class="secno">A. </bdi>Referenties</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="informatieve-referenties">
    <div class="header-wrapper"><h3 id="a-1-informatieve-referenties"><bdi class="secno">A.1 </bdi>Informatieve referenties</h3><a class="self-link" href="#informatieve-referenties" aria-label="Permalink for Appendix A.1"></a></div>
    <dl class="bibliography"><dt id="bib-oauth2">[OAuth2]</dt><dd>
      <a href="https://tools.ietf.org/html/rfc6749"><cite>The OAuth 2.0 Authorization Framework</cite></a>. D. Hardt.  The Internet Engineering Task Force. October 2012. URL: <a href="https://tools.ietf.org/html/rfc6749">https://tools.ietf.org/html/rfc6749</a>
    </dd><dt id="bib-oauth2.browser-based-apps">[OAuth2.Browser-Based-Apps]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps"><cite>OAuth 2.0 for Browser-Based Apps</cite></a>. A. Parecki; D. Waite.  IETF OAuth Working Group. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps">https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps</a>
    </dd><dt id="bib-openid.core">[OpenID.Core]</dt><dd>
      <a href="https://openid.net/specs/openid-connect-core-1_0.html"><cite>OpenID Connect Core 1.0</cite></a>. N. Sakimura, J. Bradley, M. Jones, B. de Medeiros, C. Mortimore.  OpenID foundation. November 8 2014. URL: <a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>
    </dd><dt id="bib-rfc7800">[rfc7800]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7800"><cite>Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)</cite></a>. M. Jones; J. Bradley; H. Tschofenig.  IETF. April 2016. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>
    </dd><dt id="bib-rfc8252">[RFC8252]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8252"><cite>OAuth 2.0 for Native Apps</cite></a>. W. Denniss; J. Bradley.  IETF. October 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8252">https://www.rfc-editor.org/rfc/rfc8252</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Geonovum Handreiking - Versie ter vaststelling</div><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>